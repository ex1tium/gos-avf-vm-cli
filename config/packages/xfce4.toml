# XFCE4 Desktop Configuration
# Lightweight XFCE4 desktop environment for GrapheneOS AVF VM.
#
# XFCE 4.20+ has experimental Wayland support using labwc or wayfire compositors.
# On AVF, we use cage as a minimal Wayland compositor to run XFCE4.

[meta]
name = "XFCE4"
description = "Lightweight XFCE4 desktop (via cage compositor)"
type = "desktop"

[packages]
core = [
    "xfce4",
    "xfce4-goodies",
    "cage",
]
optional = [
    "firefox-esr",
    "thunar",
    "xfce4-terminal",
]
wayland_helpers = [
    "xwayland",
]
user_packages = []

[environment]
# XFCE4 runs inside cage compositor which handles Wayland display
vars = [
    "XDG_SESSION_TYPE=wayland",
    "GDK_BACKEND=x11",
    "WLR_NO_HARDWARE_CURSORS=1",
]

[files]

[session]
# Use cage compositor to run xfce4-session
# cage is a minimal Wayland compositor that runs a single application fullscreen
start_command = "cage -- xfce4-session"
fallback_command = "cage -- startxfce4"
requires_dbus_session = true
helper_script_name = "start-xfce4"
